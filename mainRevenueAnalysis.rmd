---
title: "Quarterly State Tax Revenue Analysis"
author: "Don Boyd"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  html_document:
    toc: true
    toc_depth: 4
---



```{r defines, echo=FALSE}

qtd <- paste0(sdatd, "Data for ongoing work\\qtax rfiles\\")
qtdrop <- "C:\\Users\\Don\\Dropbox (Personal)\\R items\\qtax\\"
 
```


```{r loads, echo=FALSE}
library(btools) # library that I created (see above for installation)
library(foreign) # various import and export routines - e.g., for reading Stata files
library(gdata) # for reading spreadsheets
library(ggplot2)
library(scales) # so we can use scales with ggplot2
library(plyr) # needed for ddply [but was it already loaded??]
library(reshape2)
library(tidyr)
library(dplyr) # always load AFTER plyr
library(knitr)
library(lubridate)

# sessionInfo()

```


```{r updateapidata, eval=FALSE, echo=FALSE}
# only run this when Census has updated the quarterly tax data
source("getupdatedqtaxfromapi.r", echo=TRUE) 

```


```{r combineapihist, eval=FALSE, echo=FALSE}
# only run this when Census has updated the quarterly tax data
source("combineqtaxhistapi.r", echo=TRUE) 

```


```{r prepdata, eval=FALSE, echo=FALSE}
# only run this when Census has updated the quarterly tax data
# or when I want to add to the variables and information we want to analyze
# get price index, compute real, and compute ma4 and maybe pchya
source("prepdata.r", echo=TRUE) 
```



```{r getbasedata, echo=FALSE}
# library(hts) #  Hierarchical and grouped time series
# get the main file once, centrally, and all subprograms can use this
qtax <- readRDS(file=paste0(qtd, "qtaxrma.rds"))

# ht(qtax)
# count(qtax, "date")

```


```{r intro, child=paste0("subIntro.Rmd"), eval=TRUE}
# don't put anything else here - it WILL NOT BE RUN!
```



```{r eval=FALSE, echo=FALSE}

#****************************************************************************************************
#
#                Mess around ####
#
#***************************************************************************************************

The process is actually pretty simple. It is as follows assuming you have already set up a local github repository in Rstudio.

go to github.com and click repositories and new repository
Give the repository a name and description and create it
Follow the instructions to “push an existing repository from the command line”
For example if the repository was called foo, the commands would be:

git remote add origin https://github.com/donboyd5/RevenueReport.git
git push -u origin master

Thus, in Rstudio, you could open the shell while in your project. This would ensure that the shell is open in the working directory of your project, and then run the previous commands (naturally with the correct repository name) .

The only final problem I encountered was that I had not used github for a while and github did not have my SSH key. So I needed to add my SSH key to github. To do this:

In Rstudio click “preferences” and “view public key” and copy the whole key to the clipboard
In Github, click “edit user profile” and “SSH keys” and add the key.

```

